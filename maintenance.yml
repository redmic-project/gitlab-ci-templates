variables:
  MAINTENANCE_IMAGE: ${DOCKER_DEPLOY_IMAGE_NAME}:${DOCKER_DEPLOY_IMAGE_TAG}
  STACK: stack
  REGISTRY_URL: ${CI_REGISTRY}
  REGISTRY_USER: ${CI_DEPLOY_USER}
  REGISTRY_PASS: ${CI_DEPLOY_PASSWORD}

.scheduled-run:
  stage: maintenance
  image: ${MAINTENANCE_IMAGE}
  variables:
    SERVICE: ${STACK}_${CI_PROJECT_NAME}
  script: relaunch.sh
  only:
    - schedules

scheduled-run-development:
  extends: .scheduled-run
  variables:
    SSH_REMOTE: ${DEV_SSH_REMOTE}

scheduled-run-production:
  extends: .scheduled-run
  variables:
    SSH_REMOTE: ${PRO_SSH_REMOTE}
